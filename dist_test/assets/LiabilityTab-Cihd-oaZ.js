import{r as D,j as e,aL as S,J as K,b2 as X,Q as ee,be as te}from"./ui-Ce9YeQZa.js";import{s as ae,M as se,f as u,C as le,B as b,m as ne,D as ie,h as re,j as oe,k as ce,l as de,L as c,I as F,S as k,n as A,o as I,p as M,q as g,N as w,t as R}from"./index-DHabN7TV.js";import"./vendor-Cgg2GOmP.js";import"./motion-BWOTBQax.js";import"./charts--ivomIfj.js";const q=[{value:"home_loan",label:"ðŸ  Home Loan",icon:"ðŸ "},{value:"car_loan",label:"ðŸš— Car Loan",icon:"ðŸš—"},{value:"personal_loan",label:"ðŸ’³ Personal Loan",icon:"ðŸ’³"},{value:"credit_card",label:"ðŸ’³ Credit Card",icon:"ðŸ’³"},{value:"education_loan",label:"ðŸŽ“ Education Loan",icon:"ðŸŽ“"},{value:"other",label:"ðŸ“‹ Other",icon:"ðŸ“‹"}];function be({currency:x,expenses:T=[],accounts:L=[]}){const{liabilities:j,isLoading:O,createLiability:P,updateLiability:U,deleteLiability:_}=ae(),[V,m]=D.useState(!1),[p,E]=D.useState(null),[a,i]=D.useState({name:"",type:"personal_loan",principal:"",outstanding:"",interestRate:"",emiAmount:"",startDate:new Date().toISOString().split("T")[0],tenure:"",tenureUnit:"months",accountId:"none"}),Y=async t=>{t.preventDefault();const s=a.tenureUnit==="years"?parseInt(a.tenure)*12:parseInt(a.tenure),l={name:a.name,type:a.type,principal:parseFloat(a.principal),outstanding:parseFloat(a.outstanding),interestRate:parseFloat(a.interestRate),emiAmount:parseFloat(a.emiAmount),startDate:a.startDate,tenure:s,accountId:a.accountId&&a.accountId!=="none"?a.accountId:void 0};try{p?await U(p.id,l):await P(l),y(),m(!1)}catch(n){console.error("Error saving liability:",n)}},z=async t=>{confirm("Are you sure you want to delete this liability?")&&await _(t)},B=t=>{E(t);const s=t.tenure%12===0&&t.tenure>=12,l=s?t.tenure/12:t.tenure,n=s?"years":"months";i({name:t.name,type:t.type,principal:t.principal.toString(),outstanding:t.outstanding.toString(),interestRate:t.interestRate.toString(),emiAmount:t.emiAmount.toString(),startDate:t.startDate,tenure:l.toString(),tenureUnit:n,accountId:t.accountId||"none"}),m(!0)},y=()=>{i({name:"",type:"personal_loan",principal:"",outstanding:"",interestRate:"",emiAmount:"",startDate:new Date().toISOString().split("T")[0],tenure:"",tenureUnit:"months",accountId:"none"}),E(null)},H=()=>{const t=parseFloat(a.principal),s=parseFloat(a.interestRate),l=parseInt(a.tenure),n=a.startDate;if(!t||!s||!l){R.error("Please enter Principal, Interest Rate, and Tenure first");return}const r=a.tenureUnit==="years"?l*12:l,o=s/12/100;let d=0;o===0?d=t/r:d=t*o*Math.pow(1+o,r)/(Math.pow(1+o,r)-1);const v=new Date(n),N=new Date;let h=0;if(v<=N){const Q=N.getFullYear()-v.getFullYear(),W=N.getMonth()-v.getMonth(),Z=N.getDate()-v.getDate();h=Q*12+W,Z<0&&h--,h=Math.max(0,Math.min(h,r))}let f=0;o===0?f=t-d*h:f=t*(Math.pow(1+o,r)-Math.pow(1+o,h))/(Math.pow(1+o,r)-1),i({...a,outstanding:Math.max(0,f).toFixed(2),emiAmount:d.toFixed(2)}),R.success(`Calculated (Reducing Balance): EMI â‚¹${d.toFixed(2)}, Outstanding â‚¹${f.toFixed(2)}`)},$=t=>{const s=new Date(t.startDate),l=new Date;if(s>l)return 0;let n=0;const r=l.getFullYear()-s.getFullYear(),o=l.getMonth()-s.getMonth(),d=l.getDate()-s.getDate();return n=r*12+o,d<0&&n--,n=Math.max(0,n),Math.min(n,t.tenure)},G=j.reduce((t,s)=>t+s.emiAmount,0),C=T.filter(t=>t.category==="EMI"||t.tags?.includes("emi")||t.tags?.includes("loan")||t.description&&(t.description.toLowerCase().includes("emi")||t.description.toLowerCase().includes("loan payment"))).sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime()).slice(0,5),J=C.reduce((t,s)=>t+s.amount,0);return e.jsxs("div",{className:"space-y-6",children:[C.length>0&&e.jsxs("div",{className:"frosted-plate rounded-3xl border border-white/5 p-4 bg-transparent relative overflow-hidden",children:[e.jsx(se,{variant:"spending"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-[#0A84FF]/10 border border-[#0A84FF]/20 rounded-2xl flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6 text-[#0A84FF]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-label text-[9px] mb-1",children:"Liability Flow"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold",children:"Institutional Debt Streams"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60 uppercase font-bold tracking-widest",children:"Total Monthly EMI"}),e.jsx("p",{className:"text-balance text-xl text-rose-500 font-black tabular-nums font-mono",children:u(G,x)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Capital Outflow"}),e.jsx("p",{className:"text-balance text-xl text-[#FF9F0A]",children:u(J,x)})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-3 opacity-60",children:"Transactional History:"}),e.jsx("div",{className:"space-y-2",children:C.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-100 truncate",children:t.description}),e.jsxs("p",{className:"text-[9px] text-slate-500 uppercase font-black tracking-widest mt-1",children:[t.category," â€¢ ",new Date(t.date).toLocaleDateString()]})]}),e.jsxs("p",{className:"text-balance text-sm text-[#FF453A] whitespace-nowrap ml-3",children:["-",u(t.amount,x)]})]},s))})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-100 tracking-tight truncate",children:"Liabilities & Loans"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:"Manage institutional loans and EMIs"})]}),e.jsx(le,{onClick:()=>{y(),m(!0)},icon:K,className:"h-12",children:"Add Liability"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-label text-[10px] mb-4 ${j.length===0?"opacity-40":""}`,children:"Institutional Debt Portfolio"}),O?e.jsx("div",{className:"space-y-4",children:[1,2].map(t=>e.jsxs("div",{className:"p-5 bg-slate-800/20 border border-white/5 rounded-[24px] animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-800 rounded-2xl"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-slate-800 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-slate-800 rounded w-1/3"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(s=>e.jsx("div",{className:"h-12 bg-slate-800/50 rounded-xl"},s))}),e.jsx("div",{className:"h-2 bg-slate-800 rounded-full w-full"})]},t))}):j.length===0?e.jsxs("div",{onClick:()=>m(!0),className:"group cursor-pointer p-12 bg-black border-2 border-dashed border-white/5 sq-2xl hover:border-rose-500/30 hover:bg-white/5 transition-all duration-500 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 sq-md bg-white/5 flex items-center justify-center border border-white/10 opacity-50 group-hover:scale-105 group-hover:opacity-100 transition-all text-slate-500 group-hover:text-rose-400",children:e.jsx(S,{className:"w-8 h-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-slate-200 font-black text-xs uppercase tracking-[0.2em]",children:"Zero Debt Environment Identified"}),e.jsx("p",{className:"text-[9px] text-slate-500 uppercase tracking-widest mt-2 font-bold opacity-60",children:"Initialize strategic debt analysis node"})]})]}):e.jsx("div",{className:"space-y-4",children:j.map(t=>{const s=$(t),l=t.principal>0?Math.max(0,(t.principal-t.outstanding)/t.principal*100):0,n=q.find(r=>r.value===t.type);return e.jsxs("div",{className:"bg-black sq-xl border border-white/5 p-6 group relative overflow-hidden transition-all duration-500 hover:border-rose-500/30",children:[e.jsx("div",{className:"absolute inset-0 bg-white/[0.01] group-hover:bg-rose-500/[0.04] transition-all duration-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/5 border border-white/10 sq-md flex items-center justify-center group-hover:border-rose-500/30 transition-all duration-500",children:e.jsx("span",{className:"text-2xl",children:n?.icon})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"font-black text-xs uppercase tracking-tight text-white truncate",children:t.name}),e.jsxs("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest mt-1",children:[n?.label.replace(/^\S+ /,"")," // ",t.interestRate,"% RATE"]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>B(t),className:"w-8 h-8 p-0 text-slate-500 hover:text-white hover:bg-white/10 rounded-lg",children:e.jsx(X,{className:"w-3.5 h-3.5"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>z(t.id),className:"w-8 h-8 p-0 text-rose-500/60 hover:text-rose-400 hover:bg-rose-500/10 rounded-lg",children:e.jsx(ee,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest opacity-60",children:"Outstanding"}),e.jsx("p",{className:"text-sm font-black text-rose-500 tabular-nums font-mono",children:u(t.outstanding,x)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest opacity-60",children:"Monthly Flow"}),e.jsx("p",{className:"text-sm font-black text-orange-500 tabular-nums font-mono",children:u(t.emiAmount,x)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest opacity-60",children:"Principal"}),e.jsx("p",{className:"text-xs font-bold text-slate-400 tabular-nums font-mono",children:u(t.principal,x)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest opacity-60",children:"Cycle"}),e.jsxs("p",{className:"text-xs font-bold text-slate-400 tracking-tighter font-mono",children:[s," ",e.jsxs("span",{className:"text-[10px] opacity-40",children:["/ ",t.tenure]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:e.jsx(ne.div,{initial:{width:0},animate:{width:`${l}%`},className:"h-full bg-gradient-to-r from-rose-600 to-orange-500 shadow-[0_0_12px_rgba(225,29,72,0.4)]"})}),e.jsx("div",{className:"flex justify-between items-center text-[9px] font-black uppercase tracking-widest",children:e.jsxs("span",{className:"text-rose-500/60",children:[Math.min(100,l).toFixed(0),"% RECLAIMED"]})})]})]})]},t.id)})})]}),e.jsx(ie,{open:V,onOpenChange:t=>{m(t),t||y()},children:e.jsxs(re,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-black border-white/5 text-white p-8 custom-scrollbar sq-2xl",children:[e.jsxs(oe,{children:[e.jsxs(ce,{children:[p?"Edit":"Add"," Liability"]}),e.jsxs(de,{children:[p?"Update":"Add"," your loan or liability details"]})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-name",className:"text-label text-[10px] mb-3 block",children:"Liability Name"}),e.jsx(F,{id:"liability-name",name:"name",value:a.name,onChange:t=>i({...a,name:t.target.value}),placeholder:"e.g., Home Loan - HDFC",className:"bg-black border-white/5 sq-md h-14 text-white placeholder:text-slate-600 focus:border-[#0A84FF]/50 transition-colors",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-type",className:"text-label text-[10px] mb-3 block",children:"Debt Category"}),e.jsxs(k,{value:a.type,onValueChange:t=>i({...a,type:t}),children:[e.jsx(A,{id:"liability-type",name:"type",className:"bg-black border-white/5 sq-md h-14 text-white",children:e.jsx(I,{})}),e.jsx(M,{className:"bg-black border-white/5 text-white",children:q.map(t=>e.jsx(g,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-principal",className:"text-label text-[10px] mb-3 block",children:"Principal Amount"}),e.jsx(w,{id:"liability-principal",name:"principal",value:a.principal,onChange:t=>i({...a,principal:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-outstanding",className:"text-label text-[10px] mb-3 block",children:"Outstanding"}),e.jsx(w,{id:"liability-outstanding",name:"outstanding",value:a.outstanding,onChange:t=>i({...a,outstanding:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-rate",className:"text-label text-[10px] mb-3 block",children:"Interest Rate (%)"}),e.jsx(w,{id:"liability-rate",name:"interestRate",value:a.interestRate,onChange:t=>i({...a,interestRate:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off",allowDecimals:!0,maxDecimals:2})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-emi",className:"text-label text-[10px] mb-3 block",children:"Monthly EMI"}),e.jsx(w,{id:"liability-emi",name:"emiAmount",value:a.emiAmount,onChange:t=>i({...a,emiAmount:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-start-date",className:"text-label text-[10px] mb-3 block",children:"Start Date"}),e.jsx(F,{id:"liability-start-date",name:"startDate",type:"date",value:a.startDate,onChange:t=>i({...a,startDate:t.target.value}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-tenure",className:"text-label text-[10px] mb-3 block",children:"Tenure"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{id:"liability-tenure",name:"tenure",type:"number",value:a.tenure,onChange:t=>i({...a,tenure:t.target.value}),placeholder:a.tenureUnit==="years"?"5":"60",required:!0,className:"flex-1 bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",autoComplete:"off"}),e.jsxs(k,{value:a.tenureUnit,onValueChange:t=>i({...a,tenureUnit:t}),children:[e.jsx(A,{id:"liability-tenure-unit",name:"tenureUnit",className:"w-[110px] bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(I,{})}),e.jsxs(M,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:[e.jsx(g,{value:"months",children:"Months"}),e.jsx(g,{value:"years",children:"Years"})]})]})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs(b,{type:"button",variant:"outline",onClick:H,className:"w-full h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-[#0A84FF]/10 hover:text-[#0A84FF] transition-all",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Auto-Calculate EMI & Outstanding"]})}),L.length>0&&e.jsxs("div",{children:[e.jsx(c,{htmlFor:"liability-account",className:"text-label text-[10px] mb-3 block",children:"Linked Liquidity Node (Optional)"}),e.jsxs(k,{value:a.accountId,onValueChange:t=>i({...a,accountId:t}),children:[e.jsx(A,{id:"liability-account",name:"accountId",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(I,{placeholder:"Select account"})}),e.jsxs(M,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:[e.jsx(g,{value:"none",children:"Standalone (No Linking)"}),L.map(t=>e.jsxs(g,{value:t.id,children:[t.icon," ",t.name]},t.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1 h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsxs(b,{type:"submit",className:"flex-1 h-12 rounded-xl bg-[#0A84FF] hover:bg-[#007AFF] text-white border-none shadow-lg shadow-blue-600/10 font-bold",children:[p?"Update":"Initialize"," Liability"]})]})]})]})})]})}export{be as LiabilityTab};
