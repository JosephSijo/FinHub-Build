import{r as x,j as e,J as S,E as q,W as I,b2 as te,Q as ae,b3 as se}from"./ui-Ce9YeQZa.js";import{C as re,M as le,f as d,B as m,D as T,h as _,j as L,k as O,l as E,L as n,I as N,N as k,S as G,n as M,o as $,p as z,q as R,r as ne,t as D}from"./index-DHabN7TV.js";import"./vendor-Cgg2GOmP.js";import"./motion-BWOTBQax.js";import"./charts--ivomIfj.js";const xe=({goals:f,currency:c,accounts:l=[],expenses:V=[],incomes:B=[],onCreateGoal:P,onUpdateGoal:y,onDeleteGoal:W,onDeductFromAccount:A})=>{const[H,p]=x.useState(!1),[Y,b]=x.useState(!1),[h,J]=x.useState(null),[g,C]=x.useState(null),[a,i]=x.useState({name:"",targetAmount:0,currentAmount:0,targetDate:"",emoji:"ðŸŽ¯",monthlyContribution:0,startDate:new Date().toISOString().split("T")[0],accountId:l.length>0?l[0].id:""}),[r,j]=x.useState({amount:"",accountId:"",deductFromAccount:!1}),Q=["ðŸŽ¯","âœˆï¸","ðŸ ","ðŸš—","ðŸ’»","ðŸ“±","ðŸŽ“","ðŸ’","ðŸ–ï¸","ðŸŽ¸","ðŸ“·","âŒš"],w=t=>{t?(C(t),i({name:t.name,targetAmount:t.targetAmount,currentAmount:t.currentAmount,targetDate:t.targetDate||"",emoji:t.emoji||"ðŸŽ¯",monthlyContribution:t.monthly_contribution||0,startDate:t.startDate||(t.createdAt?t.createdAt.split("T")[0]:new Date().toISOString().split("T")[0]),accountId:l.length>0?l[0].id:""})):(C(null),i({name:"",targetAmount:0,currentAmount:0,targetDate:"",emoji:"ðŸŽ¯",monthlyContribution:0,startDate:new Date().toISOString().split("T")[0],accountId:l.length>0?l[0].id:""})),p(!0)},U=t=>{t.preventDefault();const s={name:a.name,targetAmount:a.targetAmount,currentAmount:a.currentAmount,targetDate:a.targetDate,emoji:a.emoji,monthly_contribution:a.monthlyContribution,startDate:a.startDate,accountId:a.accountId};g?y(g.id,s):P(s),p(!1)},Z=t=>{J(t),j({amount:"",accountId:l.length>0?l[0].id:"",deductFromAccount:!1}),b(!0)},K=t=>{if(t.preventDefault(),!h)return;const s=parseFloat(r.amount);if(isNaN(s)||s<=0){D.error("Please enter a valid amount");return}if(r.deductFromAccount&&r.accountId){const o=l.find(u=>u.id===r.accountId);if(o&&o.balance<s){D.error("Insufficient balance in selected account");return}A&&A(r.accountId,s)}y(h.id,{currentAmount:h.currentAmount+s}),D.success(`Added ${d(s,c)} to ${h.name}!`),b(!1)},X=f.reduce((t,s)=>t+(s?.currentAmount||0),0),F=[...V.filter(t=>t.tags&&Array.isArray(t.tags)&&t.tags.some(s=>s?.toLowerCase().includes("goal"))||t.description&&t.description.toLowerCase().includes("goal")),...B.filter(t=>t.tags&&Array.isArray(t.tags)&&t.tags.some(s=>s?.toLowerCase().includes("goal"))||t.source&&t.source.toLowerCase().includes("goal"))].sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime()).slice(0,5);return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 pt-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-100 tracking-tight truncate",children:"Saving Milestones"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:"Track progress toward long-term targets"})]}),e.jsx(re,{onClick:()=>w(),icon:S,className:"h-12",children:"New Goal"})]}),e.jsxs("div",{className:"mesh-gradient-card sq-2xl overflow-hidden group relative",children:[e.jsx(le,{variant:"savings"}),e.jsxs("div",{className:"bg-transparent p-0 relative z-10",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/leaf.png')] opacity-[0.05] pointer-events-none z-0"}),e.jsxs("div",{className:"p-6 flex items-center justify-between gap-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500/10 sq-md flex items-center justify-center border border-emerald-500/20 shadow-[0_0_15px_rgba(16,185,129,0.1)]",children:e.jsx(q,{className:"w-6 h-6 text-emerald-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-white font-black text-xs uppercase tracking-[0.3em]",children:"Victory Node"}),e.jsx("p",{className:"text-[10px] text-emerald-500/60 font-bold uppercase tracking-widest mt-1",children:"Capital Accumulation Drive"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-black tracking-[0.2em] mb-1",children:"Matured Reserve"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xl font-black text-emerald-400 tabular-nums font-mono",children:d(X,c)}),e.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 blur-xl -z-10 animate-pulse"})]})]})]}),e.jsx("div",{className:"py-4 px-6 relative z-10 border-t border-white/5",children:F.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest mb-3 opacity-50",children:"Victory Log"}),F.map((t,s)=>{const o="description"in t;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-white/5 last:border-0 hover:bg-emerald-500/5 transition-colors px-2 -mx-2 rounded-lg group/item",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-300 truncate group-hover/item:text-emerald-400 transition-colors",children:o?t.description:t.source}),e.jsx("p",{className:"text-[8px] text-slate-500 font-bold uppercase tracking-tighter mt-0.5 opacity-50",children:new Date(t.date).toLocaleDateString()})]}),e.jsxs("p",{className:`text-xs font-black font-mono tabular-nums ${o?"text-rose-500":"text-emerald-400"}`,children:[o?"-":"+",d(t.amount,c)]})]},`${t.id||s}-${s}`)})]}):e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-[10px] text-slate-600 uppercase font-black tracking-widest",children:"No recent goal movements"})})}),e.jsx("div",{className:"p-4 border-t border-white/5 bg-emerald-500/5 relative z-10",children:e.jsxs(m,{variant:"ghost",onClick:()=>{const t=window.showFundAllocation;t&&t("goal")},className:"w-full h-10 text-[9px] font-black uppercase tracking-[0.2em] text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10 flex items-center justify-center transition-all bg-emerald-500/5 sq-md border border-emerald-500/10",children:[e.jsx(I,{className:"w-3.5 h-3.5 mr-2"}),"Inject Surplus Liquidity"]})})]})]}),e.jsx(T,{open:H,onOpenChange:p,children:e.jsxs(_,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-black border-white/5 text-white p-8 custom-scrollbar sq-2xl",children:[e.jsxs(L,{children:[e.jsx(O,{children:g?"Edit Goal":"Create New Goal"}),e.jsx(E,{children:"Set a savings goal and track your progress"})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-label text-[10px] mb-3 block",children:"Select Emoji"}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-2 mt-2",children:Q.map(t=>e.jsx("button",{type:"button",onClick:()=>i({...a,emoji:t}),className:`text-2xl sm:text-3xl p-3 sq-md border transition-all ${a.emoji===t?"border-[#0A84FF] bg-[#0A84FF]/10 scale-105":"border-white/5 bg-white/5 hover:border-slate-500"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"goal-name",className:"text-label text-[10px] mb-3 block",children:"Goal Name"}),e.jsx(N,{id:"goal-name",name:"name",value:a.name,onChange:t=>i({...a,name:t.target.value}),className:"bg-black border-white/5 sq-md h-14 text-white placeholder:text-slate-600 focus:border-[#0A84FF]/50 transition-colors",placeholder:"e.g., Vacation Fund, Emergency Fund",required:!0,autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"targetAmount",className:"text-label text-[10px] mb-3 block",children:"Target Amount"}),e.jsx(k,{id:"targetAmount",name:"targetAmount",step:"0.01",value:a.targetAmount,onChange:t=>i({...a,targetAmount:parseFloat(t)||0}),className:"bg-black border-white/5 sq-md h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"currentAmount",className:"text-label text-[10px] mb-3 block",children:"Current Amount"}),e.jsx(k,{id:"currentAmount",name:"currentAmount",step:"0.01",value:a.currentAmount,onChange:t=>i({...a,currentAmount:parseFloat(t)||0}),className:"bg-black border-white/5 sq-md h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"targetDate",className:"text-label text-[10px] mb-3 block",children:"Target Date"}),e.jsx(N,{id:"targetDate",name:"targetDate",type:"date",value:a.targetDate,onChange:t=>i({...a,targetDate:t.target.value}),className:"bg-black border-white/5 sq-md h-14 text-white",required:!0})]}),e.jsxs("div",{className:"pt-4 border-t border-white/5",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-[#34D399] mb-4",children:"Automation Node (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"monthlyContribution",className:"text-label text-[10px] mb-3 block",children:"Monthly Contribution"}),e.jsx(k,{id:"monthlyContribution",name:"monthlyContribution",step:"0.01",value:a.monthlyContribution,onChange:t=>i({...a,monthlyContribution:parseFloat(t)||0}),className:"bg-black border-white/5 sq-md h-14 text-white",placeholder:"0.00",autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"startDate",className:"text-label text-[10px] mb-3 block",children:"Contribution Start Date"}),e.jsx(N,{id:"startDate",name:"startDate",type:"date",value:a.startDate,onChange:t=>i({...a,startDate:t.target.value}),className:"bg-black border-white/5 sq-md h-14 text-white"})]})]}),l.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx(n,{htmlFor:"goal-account",className:"text-label text-[10px] mb-3 block",children:"Source Liquidity Node"}),e.jsxs(G,{value:a.accountId,onValueChange:t=>i({...a,accountId:t}),children:[e.jsx(M,{id:"goal-account",className:"bg-black border-white/5 sq-md h-14 text-white",children:e.jsx($,{placeholder:"Choose account"})}),e.jsx(z,{className:"bg-black border-white/5 text-white",children:l.map(t=>e.jsxs(R,{value:t.id,children:[t.icon," ",t.name]},t.id))})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>p(!1),className:"flex-1 h-12 sq-md border-white/5 text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsx(m,{type:"submit",className:"flex-1 h-12 sq-md bg-[#0A84FF] hover:bg-[#007AFF] text-white border-none shadow-lg shadow-blue-600/10",children:g?"Update Goal":"Create Goal"})]})]})]})}),f.length===0?e.jsxs("div",{onClick:()=>w(),className:"group cursor-pointer p-12 bg-black border-2 border-dashed border-white/5 sq-2xl hover:border-slate-600/50 hover:bg-white/5 transition-all duration-300 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 sq-md bg-white/5 flex items-center justify-center border border-white/5 opacity-50 group-hover:scale-105 transition-transform",children:e.jsx(q,{className:"w-8 h-8 text-slate-500"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-slate-200 font-bold text-lg",children:"No goals tracked yet. Want to see your future here?"}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-[0.2em] mt-2 font-black",children:"Tap to Define Savings Target"})]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((t,s)=>{const o=t.currentAmount/t.targetAmount*100,u=o>=100,v=Math.ceil((new Date(t.targetDate).getTime()-new Date().getTime())/(1e3*60*60*24)),ee={"--progress-width":`${Math.min(100,o)}%`};return e.jsxs("div",{className:"bg-black sq-xl border border-white/5 p-6 group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/[0.01] group-hover:bg-emerald-500/[0.04] transition-all duration-500"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/5 border border-white/10 sq-md flex items-center justify-center group-hover:border-emerald-500/30 transition-all duration-500",children:e.jsx("span",{className:"text-2xl",children:t.emoji})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"font-black text-xs uppercase tracking-tight text-white truncate",children:t.name||"UNNAMED NODE"}),u?e.jsxs("p",{className:"text-[10px] text-emerald-400 font-bold uppercase tracking-widest mt-1 flex items-center gap-1.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse shadow-[0_0_8px_rgba(52,211,153,0.5)]"}),"Target Secured"]}):e.jsx("p",{className:`text-[11px] font-black uppercase tracking-widest mt-1 ${v>0?"text-slate-500":"text-rose-500"}`,children:v>0?`${v} DAYS REMAINING`:"TEMPORAL DRIFT"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>w(t),className:"w-8 h-8 p-0 text-slate-500 hover:text-white hover:bg-white/10 rounded-lg",children:e.jsx(te,{className:"w-3.5 h-3.5"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>W(t.id),className:"w-8 h-8 p-0 text-rose-500/60 hover:text-rose-400 hover:bg-rose-500/10 rounded-lg",children:e.jsx(ae,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest mb-1.5 opacity-60",children:"Locked Reserve"}),e.jsx("p",{className:"text-sm font-black text-emerald-400 tabular-nums font-mono",children:d(t.currentAmount,c)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[8px] text-slate-500 uppercase font-black tracking-widest mb-1.5 opacity-60",children:"Success Point"}),e.jsx("p",{className:"text-sm font-black text-slate-300 tabular-nums font-mono opacity-60",children:d(t.targetAmount,c)})]})]}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${u?"bg-gradient-to-r from-emerald-600 to-teal-400 shadow-[0_0_12px_rgba(16,185,129,0.4)]":"bg-emerald-500/40 shadow-[0_0_8px_rgba(16,185,129,0.2)]"}`,style:ee})}),e.jsx("div",{className:"flex justify-between items-center text-[9px] font-black uppercase tracking-widest",children:e.jsxs("span",{className:u?"text-emerald-400":"text-emerald-500/60",children:[Math.min(100,o).toFixed(0),"% SYNCHRONIZED"]})})]}),e.jsxs(m,{onClick:()=>Z(t),className:"w-full bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 hover:border-emerald-500/40 sq-md font-black text-[10px] uppercase tracking-widest py-6 transition-all shadow-[0_0_20px_rgba(16,185,129,0.1)]",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Inject Capital"]})]})]},`${t.id}-${s}`)})}),e.jsx(T,{open:Y,onOpenChange:b,children:e.jsxs(_,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-black border-white/5 text-white p-8 custom-scrollbar sq-2xl",children:[e.jsxs(L,{children:[e.jsxs(O,{children:["Add Funds to ",h?.name]}),e.jsx(E,{children:"Contribute to your savings goal"})]}),e.jsxs("form",{onSubmit:K,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsxs(n,{htmlFor:"fund-amount",className:"text-label text-[10px] mb-3 flex items-center gap-2",children:[e.jsx(se,{className:"w-3 h-3 text-[#30D158]"}),"Contribution Amount"]}),e.jsx(N,{id:"fund-amount",name:"amount",type:"number",step:"0.01",value:r.amount,onChange:t=>j({...r,amount:t.target.value}),placeholder:"0.00",className:"bg-black border-white/5 sq-md h-14 text-white text-lg placeholder:text-slate-600",required:!0,autoFocus:!0,autoComplete:"off"}),e.jsxs("p",{className:"text-[10px] text-slate-500 mt-2 italic px-1",children:[d(r.amount||0,c)," will be added to your milestone"]})]}),l.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-black p-4 sq-md border border-white/5",children:[e.jsx(ne,{id:"deduct",checked:r.deductFromAccount,onCheckedChange:t=>j({...r,deductFromAccount:t}),className:"border-slate-500 data-[state=checked]:bg-[#30D158] data-[state=checked]:border-[#30D158]"}),e.jsxs(n,{htmlFor:"deduct",className:"text-xs font-bold text-slate-200 cursor-pointer flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-slate-500"}),"Deduct from Liquidity Node"]})]}),r.deductFromAccount&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx(n,{htmlFor:"fund-account",className:"text-label text-[10px] mb-3 block",children:"Source Account"}),e.jsxs(G,{value:r.accountId,onValueChange:t=>j({...r,accountId:t}),children:[e.jsx(M,{id:"fund-account",name:"accountId",className:"bg-black border-white/5 sq-md h-14 text-white",children:e.jsx($,{placeholder:"Choose account"})}),e.jsx(z,{className:"bg-black border-white/5 text-white",children:l.map(t=>e.jsx(R,{value:t.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{children:[t.icon," ",t.name]}),e.jsx("span",{className:"text-[10px] text-slate-500 ml-4 font-mono",children:d(t.balance,c)})]})},t.id))})]}),r.accountId&&e.jsxs("p",{className:"text-[10px] text-slate-500 mt-2 italic px-1",children:["Available Liquidity: ",d(l.find(t=>t.id===r.accountId)?.balance||0,c)]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>b(!1),className:"flex-1 h-12 sq-md border-white/5 text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsx(m,{type:"submit",className:"flex-1 h-12 sq-md bg-[#30D158] hover:bg-[#28B54C] text-white border-none shadow-lg shadow-green-600/10",children:"Capitalize Milestone"})]})]})]})})]})};export{xe as GoalsTracker};
