import{r as h,j as e,K as k,W as E,x as S,aH as Y,B as Z,aI as ee}from"./ui-DwNC2Rqb.js";import{a as c,B as n,D as T,g as I,h as G,j as $,k as L,L as i,I as w,N as q,C as te,l as se,S as ae,n as le,o as re,p as ne,q as oe,t as A}from"./index-DKCn1eko.js";import"./vendor-7PqXWhc5.js";import"./motion-BKne_-B1.js";const me=({goals:p,currency:o,accounts:m=[],expenses:O=[],incomes:M=[],onCreateGoal:_,onUpdateGoal:C,onDeleteGoal:B,onDeductFromAccount:D})=>{const[P,g]=h.useState(!1),[z,b]=h.useState(!1),[u,V]=h.useState(null),[j,y]=h.useState(null),[a,d]=h.useState({name:"",targetAmount:0,currentAmount:0,targetDate:"",emoji:"ðŸŽ¯"}),[l,f]=h.useState({amount:"",accountId:"",deductFromAccount:!1}),W=["ðŸŽ¯","âœˆï¸","ðŸ ","ðŸš—","ðŸ’»","ðŸ“±","ðŸŽ“","ðŸ’","ðŸ–ï¸","ðŸŽ¸","ðŸ“·","âŒš"],N=t=>{t?(y(t),d({name:t.name,targetAmount:t.targetAmount,currentAmount:t.currentAmount,targetDate:t.targetDate||"",emoji:t.emoji||"ðŸŽ¯"})):(y(null),d({name:"",targetAmount:0,currentAmount:0,targetDate:"",emoji:"ðŸŽ¯"})),g(!0)},H=t=>{t.preventDefault();const s={name:a.name,targetAmount:a.targetAmount,currentAmount:a.currentAmount,targetDate:a.targetDate,emoji:a.emoji};j?C(j.id,s):_(s),g(!1)},R=t=>{V(t),f({amount:"",accountId:m.length>0?m[0].id:"",deductFromAccount:!1}),b(!0)},K=t=>{if(t.preventDefault(),!u)return;const s=parseFloat(l.amount);if(isNaN(s)||s<=0){A.error("Please enter a valid amount");return}if(l.deductFromAccount&&l.accountId){const r=m.find(x=>x.id===l.accountId);if(r&&r.balance<s){A.error("Insufficient balance in selected account");return}D&&D(l.accountId,s)}C(u.id,{currentAmount:u.currentAmount+s}),A.success(`Added ${c(s,o)} to ${u.name}!`),b(!1)},U=p.reduce((t,s)=>t+(s?.currentAmount||0),0),J=p.filter(t=>t?.currentAmount<t?.targetAmount).length,F=[...O.filter(t=>t.tags&&Array.isArray(t.tags)&&t.tags.some(s=>s?.toLowerCase().includes("goal"))||t.description&&t.description.toLowerCase().includes("goal")),...M.filter(t=>t.tags&&Array.isArray(t.tags)&&t.tags.some(s=>s?.toLowerCase().includes("goal"))||t.source&&t.source.toLowerCase().includes("goal"))].sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime()).slice(0,5);return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsxs("div",{className:"segmented-stack",children:[e.jsxs("div",{className:"stack-cap",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-[#30D158]/10 rounded-xl flex items-center justify-center border border-[#30D158]/20",children:e.jsx(k,{className:"w-5 h-5 text-[#30D158]"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-label text-[10px]",children:"Capital Accumulation"}),e.jsx("h3",{className:"text-balance text-lg text-slate-100",children:c(U,o)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-label text-[10px] opacity-60",children:"Active Targets"}),e.jsxs("p",{className:"text-balance text-sm text-[#30D158]",children:[J," ",e.jsx("span",{className:"text-[10px] opacity-60 uppercase font-black tracking-widest",children:"Milestones"})]})]})]}),e.jsx("div",{className:"stack-body py-4 px-6",children:F.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-label text-[8px] opacity-50 uppercase font-black tracking-widest mb-3",children:"Audit Trail"}),F.map((t,s)=>{const r="description"in t;return e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors px-2 -mx-2 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-200 truncate",children:r?t.description:t.source}),e.jsx("p",{className:"text-label text-[8px] mt-0.5 opacity-50",children:new Date(t.date).toLocaleDateString()})]}),e.jsxs("p",{className:`text-balance text-xs font-bold ${r?"text-[#FF453A]":"text-[#30D158]"}`,children:[r?"-":"+",c(t.amount,o)]})]},`${t.id||s}-${s}`)})]}):e.jsx("div",{className:"py-8 text-center",children:e.jsx("p",{className:"text-[10px] text-slate-600 uppercase font-black tracking-widest",children:"No recent goal movements"})})}),e.jsx("div",{className:"stack-footer",children:e.jsxs(n,{variant:"ghost",onClick:()=>{window.showFundAllocation&&window.showFundAllocation("goal")},className:"w-full h-10 text-xs font-bold text-slate-400 hover:text-slate-100 hover:bg-white/5 flex items-center justify-center transition-all bg-black/20",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Allocate Excess Capital to Goals"]})})]}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-100 tracking-tight truncate",children:"Saving Milestones"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:"Track progress toward long-term targets"})]}),e.jsxs(n,{onClick:()=>N(),className:"bg-[#0A84FF] hover:bg-[#007AFF] text-white rounded-xl h-12 px-6 border-none shadow-lg shadow-blue-600/10 flex items-center gap-2 group transition-all hover:scale-[1.02] active:scale-[0.98] shrink-0",children:[e.jsx(S,{className:"w-5 h-5 group-hover:rotate-90 transition-transform"}),e.jsx("span",{className:"font-bold hidden sm:inline",children:"New Goal"}),e.jsx("span",{className:"font-bold sm:hidden",children:"Add"})]})]}),e.jsx(T,{open:P,onOpenChange:g,children:e.jsxs(I,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-[#1C1C1E] border-[#38383A] text-white p-8 custom-scrollbar",children:[e.jsxs(G,{children:[e.jsx($,{children:j?"Edit Goal":"Create New Goal"}),e.jsx(L,{children:"Set a savings goal and track your progress"})]}),e.jsxs("form",{onSubmit:H,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-label text-[10px] mb-3 block",children:"Select Emoji"}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 gap-2 mt-2",children:W.map(t=>e.jsx("button",{type:"button",onClick:()=>d({...a,emoji:t}),className:`text-2xl sm:text-3xl p-3 rounded-2xl border transition-all ${a.emoji===t?"border-[#0A84FF] bg-[#0A84FF]/10 scale-105":"border-[#38383A] bg-[#2C2C2E] hover:border-[#8E8E93]"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"goal-name",className:"text-label text-[10px] mb-3 block",children:"Goal Name"}),e.jsx(w,{id:"goal-name",name:"name",value:a.name,onChange:t=>d({...a,name:t.target.value}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white placeholder:text-slate-600 focus:border-[#0A84FF]/50 transition-colors",placeholder:"e.g., Vacation Fund, Emergency Fund",required:!0,autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"targetAmount",className:"text-label text-[10px] mb-3 block",children:"Target Amount"}),e.jsx(q,{id:"targetAmount",name:"targetAmount",step:"0.01",value:a.targetAmount,onChange:t=>d({...a,targetAmount:parseFloat(t)||0}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"currentAmount",className:"text-label text-[10px] mb-3 block",children:"Current Amount"}),e.jsx(q,{id:"currentAmount",name:"currentAmount",step:"0.01",value:a.currentAmount,onChange:t=>d({...a,currentAmount:parseFloat(t)||0}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"targetDate",className:"text-label text-[10px] mb-3 block",children:"Target Date"}),e.jsx(w,{id:"targetDate",name:"targetDate",type:"date",value:a.targetDate,onChange:t=>d({...a,targetDate:t.target.value}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>g(!1),className:"flex-1 h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsx(n,{type:"submit",className:"flex-1 h-12 rounded-xl bg-[#0A84FF] hover:bg-[#007AFF] text-white border-none shadow-lg shadow-blue-600/10",children:j?"Update Goal":"Create Goal"})]})]})]})}),p.length===0?e.jsxs("div",{onClick:()=>N(),className:"group cursor-pointer p-12 bg-slate-800/10 border-2 border-dashed border-slate-700/30 rounded-[32px] hover:border-slate-600/50 hover:bg-slate-800/20 transition-all duration-300 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-slate-800/50 flex items-center justify-center border border-white/5 opacity-50 group-hover:scale-105 transition-transform",children:e.jsx(k,{className:"w-8 h-8 text-slate-500"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-slate-200 font-bold text-lg",children:"No goals tracked yet. Want to see your future here?"}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-[0.2em] mt-2 font-black",children:"Tap to Define Savings Target"})]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map((t,s)=>{const r=t.currentAmount/t.targetAmount*100,x=r>=100,v=Math.ceil((new Date(t.targetDate).getTime()-new Date().getTime())/(1e3*60*60*24)),Q={"--progress-width":`${Math.min(100,r)}%`};return e.jsxs(te,{className:`p-6 bg-[#1C1C1E] border-white/5 rounded-[28px] border hover:bg-[#2C2C2E] transition-all duration-300 group ${x?"ring-2 ring-[#30D158]/20":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-slate-800 border border-white/5 rounded-2xl flex items-center justify-center shadow-inner group-hover:scale-105 transition-transform text-3xl",children:t.emoji}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-base font-bold text-slate-100 truncate",children:t.name||"Unnamed Goal"}),x?e.jsxs("p",{className:"text-label text-[8px] text-[#30D158] mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[#30D158] animate-pulse"}),"Target Reached"]}):e.jsx("p",{className:`text-label text-[8px] mt-1 ${v>0?"text-[#8E8E93]":"text-[#FF453A]"}`,children:v>0?`${v} days remaining`:"Schedule Slip"})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>N(t),className:"w-8 h-8 p-0 rounded-lg hover:bg-blue-500/10 hover:text-blue-400 text-slate-500",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>B(t.id),className:"w-8 h-8 p-0 rounded-lg hover:bg-rose-500/10 hover:text-rose-400 text-slate-500",children:e.jsx(Z,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-label text-[8px] opacity-60 mb-0.5",children:"Funded"}),e.jsx("span",{className:"text-balance text-lg text-slate-100 leading-none",children:c(t.currentAmount,o)})]}),e.jsxs("div",{className:"text-right flex flex-col items-end",children:[e.jsx("span",{className:"text-label text-[8px] opacity-60 mb-0.5",children:"Target"}),e.jsx("span",{className:"text-balance text-xs text-[#8E8E93] leading-none",children:c(t.targetAmount,o)})]})]}),e.jsx("div",{className:"relative h-1.5 w-full bg-black/40 rounded-full overflow-hidden border border-white/5",children:(()=>{const X={style:Q};return e.jsx("div",{className:`h-full rounded-full transition-all duration-1000 w-[var(--progress-width)] ${x?"bg-[#30D158] shadow-[0_0_10px_rgba(48,209,88,0.3)]":"bg-[#0A84FF] shadow-[0_0_10px_rgba(10,132,255,0.3)]"}`,...X})})()}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest",children:[e.jsxs("span",{className:x?"text-emerald-500":"text-blue-500",children:[Math.min(100,r).toFixed(0),"% Progress"]}),e.jsx("span",{className:"text-slate-600",children:t.targetDate?`By ${new Date(t.targetDate).toLocaleDateString(void 0,{month:"short",year:"numeric"})}`:""})]})]}),!x&&e.jsxs(n,{onClick:()=>R(t),className:"w-full bg-[#30D158]/10 hover:bg-[#30D158] text-[#30D158] hover:text-white border border-[#30D158]/20 hover:border-[#30D158] rounded-xl font-bold py-6 transition-all",children:[e.jsx(S,{className:"w-5 h-5 mr-2"}),"Capitalize"]})]},`${t.id}-${s}`)})}),e.jsx(T,{open:z,onOpenChange:b,children:e.jsxs(I,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-[#1C1C1E] border-[#38383A] text-white p-8 custom-scrollbar",children:[e.jsxs(G,{children:[e.jsxs($,{children:["Add Funds to ",u?.name]}),e.jsx(L,{children:"Contribute to your savings goal"})]}),e.jsxs("form",{onSubmit:K,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsxs(i,{htmlFor:"fund-amount",className:"text-label text-[10px] mb-3 flex items-center gap-2",children:[e.jsx(ee,{className:"w-3 h-3 text-[#30D158]"}),"Contribution Amount"]}),e.jsx(w,{id:"fund-amount",name:"amount",type:"number",step:"0.01",value:l.amount,onChange:t=>f({...l,amount:t.target.value}),placeholder:"0.00",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white text-lg placeholder:text-slate-600",required:!0,autoFocus:!0,autoComplete:"off"}),e.jsxs("p",{className:"text-[10px] text-slate-500 mt-2 italic px-1",children:[c(l.amount||0,o)," will be added to your milestone"]})]}),m.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-[#2C2C2E] p-4 rounded-xl border border-[#38383A]",children:[e.jsx(se,{id:"deduct",checked:l.deductFromAccount,onCheckedChange:t=>f({...l,deductFromAccount:t}),className:"border-slate-500 data-[state=checked]:bg-[#30D158] data-[state=checked]:border-[#30D158]"}),e.jsxs(i,{htmlFor:"deduct",className:"text-xs font-bold text-slate-200 cursor-pointer flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-slate-500"}),"Deduct from Liquidity Node"]})]}),l.deductFromAccount&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx(i,{htmlFor:"fund-account",className:"text-label text-[10px] mb-3 block",children:"Source Account"}),e.jsxs(ae,{value:l.accountId,onValueChange:t=>f({...l,accountId:t}),children:[e.jsx(le,{id:"fund-account",name:"accountId",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(re,{placeholder:"Choose account"})}),e.jsx(ne,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:m.map(t=>e.jsx(oe,{value:t.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{children:[t.icon," ",t.name]}),e.jsx("span",{className:"text-[10px] text-slate-500 ml-4 font-mono",children:c(t.balance,o)})]})},t.id))})]}),l.accountId&&e.jsxs("p",{className:"text-[10px] text-slate-500 mt-2 italic px-1",children:["Available Liquidity: ",c(m.find(t=>t.id===l.accountId)?.balance||0,o)]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>b(!1),className:"flex-1 h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsx(n,{type:"submit",className:"flex-1 h-12 rounded-xl bg-[#30D158] hover:bg-[#28B54C] text-white border-none shadow-lg shadow-green-600/10",children:"Capitalize Milestone"})]})]})]})})]})};export{me as GoalsTracker};
