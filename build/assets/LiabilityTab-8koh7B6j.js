import{r as F,j as e,at as S,x as X,aH as Z,B as ee,aT as te}from"./ui-DwNC2Rqb.js";import{r as ae,C as se,a as u,B as p,m as le,D as ne,g as ie,h as re,j as oe,k as de,L as d,I as A,S as D,n as I,o as E,p as k,q as g,N as w,t as T}from"./index-DKCn1eko.js";import"./vendor-7PqXWhc5.js";import"./motion-BKne_-B1.js";const R=[{value:"home_loan",label:"ðŸ  Home Loan",icon:"ðŸ "},{value:"car_loan",label:"ðŸš— Car Loan",icon:"ðŸš—"},{value:"personal_loan",label:"ðŸ’³ Personal Loan",icon:"ðŸ’³"},{value:"credit_card",label:"ðŸ’³ Credit Card",icon:"ðŸ’³"},{value:"education_loan",label:"ðŸŽ“ Education Loan",icon:"ðŸŽ“"},{value:"other",label:"ðŸ“‹ Other",icon:"ðŸ“‹"}];function ue({currency:x,expenses:O=[],accounts:M=[]}){const{liabilities:j,isLoading:P,createLiability:U,updateLiability:q,deleteLiability:V}=ae(),[Y,m]=F.useState(!1),[b,L]=F.useState(null),[a,i]=F.useState({name:"",type:"personal_loan",principal:"",outstanding:"",interestRate:"",emiAmount:"",startDate:new Date().toISOString().split("T")[0],tenure:"",tenureUnit:"months",accountId:"none"}),_=async t=>{t.preventDefault();const s=a.tenureUnit==="years"?parseInt(a.tenure)*12:parseInt(a.tenure),l={name:a.name,type:a.type,principal:parseFloat(a.principal),outstanding:parseFloat(a.outstanding),interestRate:parseFloat(a.interestRate),emiAmount:parseFloat(a.emiAmount),startDate:a.startDate,tenure:s,accountId:a.accountId&&a.accountId!=="none"?a.accountId:void 0};try{b?await q(b.id,l):await U(l),C(),m(!1)}catch(n){console.error("Error saving liability:",n)}},H=async t=>{confirm("Are you sure you want to delete this liability?")&&await V(t)},B=t=>{L(t);const s=t.tenure%12===0&&t.tenure>=12,l=s?t.tenure/12:t.tenure,n=s?"years":"months";i({name:t.name,type:t.type,principal:t.principal.toString(),outstanding:t.outstanding.toString(),interestRate:t.interestRate.toString(),emiAmount:t.emiAmount.toString(),startDate:t.startDate,tenure:l.toString(),tenureUnit:n,accountId:t.accountId||"none"}),m(!0)},C=()=>{i({name:"",type:"personal_loan",principal:"",outstanding:"",interestRate:"",emiAmount:"",startDate:new Date().toISOString().split("T")[0],tenure:"",tenureUnit:"months",accountId:"none"}),L(null)},z=()=>{const t=parseFloat(a.principal),s=parseFloat(a.interestRate),l=parseInt(a.tenure),n=a.startDate;if(!t||!s||!l){T.error("Please enter Principal, Interest Rate, and Tenure first");return}const r=a.tenureUnit==="years"?l*12:l,o=s/12/100;let c=0;o===0?c=t/r:c=t*o*Math.pow(1+o,r)/(Math.pow(1+o,r)-1);const N=new Date(n),v=new Date;let h=0;if(N<=v){const J=v.getFullYear()-N.getFullYear(),K=v.getMonth()-N.getMonth(),Q=v.getDate()-N.getDate();h=J*12+K,Q<0&&h--,h=Math.max(0,Math.min(h,r))}let f=0;o===0?f=t-c*h:f=t*(Math.pow(1+o,r)-Math.pow(1+o,h))/(Math.pow(1+o,r)-1),i({...a,outstanding:Math.max(0,f).toFixed(2),emiAmount:c.toFixed(2)}),T.success(`Calculated (Reducing Balance): EMI â‚¹${c.toFixed(2)}, Outstanding â‚¹${f.toFixed(2)}`)},$=t=>{const s=new Date(t.startDate),l=new Date;if(s>l)return 0;let n=0;const r=l.getFullYear()-s.getFullYear(),o=l.getMonth()-s.getMonth(),c=l.getDate()-s.getDate();return n=r*12+o,c<0&&n--,n=Math.max(0,n),Math.min(n,t.tenure)},W=j.reduce((t,s)=>t+s.emiAmount,0),y=O.filter(t=>t.category==="EMI"||t.tags?.includes("emi")||t.tags?.includes("loan")||t.description&&(t.description.toLowerCase().includes("emi")||t.description.toLowerCase().includes("loan payment"))).sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime()).slice(0,5),G=y.reduce((t,s)=>t+s.amount,0);return e.jsxs("div",{className:"space-y-6",children:[y.length>0&&e.jsxs(se,{className:"p-4 bg-[#1C1C1E] border border-white/5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-[#0A84FF]/10 border border-[#0A84FF]/20 rounded-2xl flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6 text-[#0A84FF]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-label text-[9px] mb-1",children:"Liability Flow"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold",children:"Institutional Debt Streams"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Total EMI/Month"}),e.jsx("p",{className:"text-balance text-xl text-[#FF453A]",children:u(W,x)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Capital Outflow"}),e.jsx("p",{className:"text-balance text-xl text-[#FF9F0A]",children:u(G,x)})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-3 opacity-60",children:"Transactional History:"}),e.jsx("div",{className:"space-y-2",children:y.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between bg-black/40 p-3 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-100 truncate",children:t.description}),e.jsxs("p",{className:"text-[9px] text-slate-500 uppercase font-black tracking-widest mt-1",children:[t.category," â€¢ ",new Date(t.date).toLocaleDateString()]})]}),e.jsxs("p",{className:"text-balance text-sm text-[#FF453A] whitespace-nowrap ml-3",children:["-",u(t.amount,x)]})]},s))})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-100 tracking-tight truncate",children:"Liabilities & Loans"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 truncate",children:"Manage institutional loans and EMIs"})]}),e.jsxs(p,{onClick:()=>{C(),m(!0)},className:"bg-[#0A84FF] hover:bg-[#007AFF] text-white rounded-xl h-12 px-6 border-none shadow-lg shadow-blue-600/10 flex items-center gap-2 group transition-all hover:scale-[1.02] active:scale-[0.98] shrink-0",children:[e.jsx(X,{className:"w-5 h-5 group-hover:rotate-90 transition-transform"}),e.jsx("span",{className:"font-bold hidden sm:inline",children:"Add Liability"}),e.jsx("span",{className:"font-bold sm:hidden",children:"Add"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-label text-[10px] mb-4 ${j.length===0?"opacity-40":""}`,children:"Institutional Debt Portfolio"}),P?e.jsx("div",{className:"space-y-4",children:[1,2].map(t=>e.jsxs("div",{className:"p-5 bg-slate-800/20 border border-white/5 rounded-[24px] animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-800 rounded-2xl"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx("div",{className:"h-4 bg-slate-800 rounded w-1/4"}),e.jsx("div",{className:"h-3 bg-slate-800 rounded w-1/3"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(s=>e.jsx("div",{className:"h-12 bg-slate-800/50 rounded-xl"},s))}),e.jsx("div",{className:"h-2 bg-slate-800 rounded-full w-full"})]},t))}):j.length===0?e.jsxs("div",{onClick:()=>m(!0),className:"group cursor-pointer p-12 bg-slate-800/10 border-2 border-dashed border-slate-700/30 rounded-[32px] hover:border-slate-600/50 hover:bg-slate-800/20 transition-all duration-300 flex flex-col items-center justify-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-slate-800/50 flex items-center justify-center border border-white/5 opacity-50 group-hover:scale-105 transition-transform text-slate-500",children:e.jsx(S,{className:"w-8 h-8"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-slate-200 font-bold text-lg",children:"No liabilities tracked yet. Want to manage your debt flow?"}),e.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-[0.2em] mt-2 font-black",children:"Tap to Initialize Liability Tracker"})]})]}):e.jsx("div",{className:"space-y-4",children:j.map(t=>{const s=$(t),l=t.principal>0?(t.principal-t.outstanding)/t.principal*100:0,n=R.find(r=>r.value===t.type);return e.jsxs("div",{className:"p-5 bg-[#1C1C1E] border border-white/5 rounded-[28px] group hover:bg-[#2C2C2E] transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-black/40 border border-white/10 rounded-2xl flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:n?.icon})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-100",children:t.name}),e.jsxs("p",{className:"text-label text-[10px]",children:[n?.label.replace(/^\S+ /,"")," â€¢ ",t.interestRate,"% interest"]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>B(t),className:"text-slate-400 hover:text-white hover:bg-white/5",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>H(t.id),className:"text-rose-400 hover:text-rose-300 hover:bg-rose-500/10",children:e.jsx(ee,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-black/40 p-3 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Principal"}),e.jsx("p",{className:"text-balance text-sm text-slate-200",children:u(t.principal,x)})]}),e.jsxs("div",{className:"bg-black/40 p-3 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Outstanding"}),e.jsx("p",{className:"text-balance text-sm text-[#FF453A]",children:u(t.outstanding,x)})]}),e.jsxs("div",{className:"bg-black/40 p-3 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Monthly EMI"}),e.jsx("p",{className:"text-balance text-sm text-[#FF9F0A]",children:u(t.emiAmount,x)})]}),e.jsxs("div",{className:"bg-black/40 p-3 rounded-2xl border border-white/5",children:[e.jsx("p",{className:"text-label text-[8px] mb-1 opacity-60",children:"Tenure"}),e.jsxs("p",{className:"text-balance text-sm text-slate-200",children:[s," / ",t.tenure," mo"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-label text-[8px] opacity-60",children:[e.jsx("span",{children:"Repayment Momentum"}),e.jsxs("span",{className:"text-[#30D158]",children:[l.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-1 w-full bg-black/40 rounded-full overflow-hidden",children:e.jsx(le.div,{initial:{width:0},animate:{width:`${l}%`},className:"h-full bg-gradient-to-r from-[#30D158] to-[#0A84FF]"})})]})]},t.id)})})]}),e.jsx(ne,{open:Y,onOpenChange:t=>{m(t),t||C()},children:e.jsxs(ie,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-[#1C1C1E] border-[#38383A] text-white p-8 custom-scrollbar",children:[e.jsxs(re,{children:[e.jsxs(oe,{children:[b?"Edit":"Add"," Liability"]}),e.jsxs(de,{children:[b?"Update":"Add"," your loan or liability details"]})]}),e.jsxs("form",{onSubmit:_,className:"space-y-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-name",className:"text-label text-[10px] mb-3 block",children:"Liability Name"}),e.jsx(A,{id:"liability-name",name:"name",value:a.name,onChange:t=>i({...a,name:t.target.value}),placeholder:"e.g., Home Loan - HDFC",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white placeholder:text-slate-600 focus:border-[#0A84FF]/50 transition-colors",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-type",className:"text-label text-[10px] mb-3 block",children:"Debt Category"}),e.jsxs(D,{value:a.type,onValueChange:t=>i({...a,type:t}),children:[e.jsx(I,{id:"liability-type",name:"type",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(E,{})}),e.jsx(k,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:R.map(t=>e.jsx(g,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-principal",className:"text-label text-[10px] mb-3 block",children:"Principal Amount"}),e.jsx(w,{id:"liability-principal",name:"principal",value:a.principal,onChange:t=>i({...a,principal:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-outstanding",className:"text-label text-[10px] mb-3 block",children:"Outstanding"}),e.jsx(w,{id:"liability-outstanding",name:"outstanding",value:a.outstanding,onChange:t=>i({...a,outstanding:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-rate",className:"text-label text-[10px] mb-3 block",children:"Interest Rate (%)"}),e.jsx(w,{id:"liability-rate",name:"interestRate",value:a.interestRate,onChange:t=>i({...a,interestRate:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-emi",className:"text-label text-[10px] mb-3 block",children:"Monthly EMI"}),e.jsx(w,{id:"liability-emi",name:"emiAmount",value:a.emiAmount,onChange:t=>i({...a,emiAmount:t}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",placeholder:"0.00",required:!0,autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-start-date",className:"text-label text-[10px] mb-3 block",children:"Start Date"}),e.jsx(A,{id:"liability-start-date",name:"startDate",type:"date",value:a.startDate,onChange:t=>i({...a,startDate:t.target.value}),className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-tenure",className:"text-label text-[10px] mb-3 block",children:"Tenure"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{id:"liability-tenure",name:"tenure",type:"number",value:a.tenure,onChange:t=>i({...a,tenure:t.target.value}),placeholder:a.tenureUnit==="years"?"5":"60",required:!0,className:"flex-1 bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",autoComplete:"off"}),e.jsxs(D,{value:a.tenureUnit,onValueChange:t=>i({...a,tenureUnit:t}),children:[e.jsx(I,{id:"liability-tenure-unit",name:"tenureUnit",className:"w-[110px] bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(E,{})}),e.jsxs(k,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:[e.jsx(g,{value:"months",children:"Months"}),e.jsx(g,{value:"years",children:"Years"})]})]})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs(p,{type:"button",variant:"outline",onClick:z,className:"w-full h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-[#0A84FF]/10 hover:text-[#0A84FF] transition-all",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Auto-Calculate EMI & Outstanding"]})}),M.length>0&&e.jsxs("div",{children:[e.jsx(d,{htmlFor:"liability-account",className:"text-label text-[10px] mb-3 block",children:"Linked Liquidity Node (Optional)"}),e.jsxs(D,{value:a.accountId,onValueChange:t=>i({...a,accountId:t}),children:[e.jsx(I,{id:"liability-account",name:"accountId",className:"bg-[#2C2C2E] border-[#38383A] rounded-xl h-14 text-white",children:e.jsx(E,{placeholder:"Select account"})}),e.jsxs(k,{className:"bg-[#1C1C1E] border-[#38383A] text-white",children:[e.jsx(g,{value:"none",children:"Standalone (No Linking)"}),M.map(t=>e.jsxs(g,{value:t.id,children:[t.icon," ",t.name]},t.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1 h-12 rounded-xl border-[#38383A] text-slate-400 hover:bg-white/5 hover:text-white",children:"Cancel"}),e.jsxs(p,{type:"submit",className:"flex-1 h-12 rounded-xl bg-[#0A84FF] hover:bg-[#007AFF] text-white border-none shadow-lg shadow-blue-600/10 font-bold",children:[b?"Update":"Initialize"," Liability"]})]})]})]})})]})}export{ue as LiabilityTab};
